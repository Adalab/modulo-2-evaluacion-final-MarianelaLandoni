"use strict";const inputUser=document.querySelector(".js_inputUser"),btnSearch=document.querySelector(".js_btnSearch"),btnReset=document.querySelector(".js_btnReset"),listResults=document.querySelector(".js_listResults"),listFavourites=document.querySelector(".js_listFavourites");let dataAnime=[],favouritesAnime=[];function renderFavourites(){let e="";for(const t of favouritesAnime)e+=`<li class="listAnime  js_eachAnime" id="${t.mal_id} ">`,e+=`<h3>${t.title}</h3>`,"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===t.images.jpg.image_url?e+=" <img class=\"imgAnime\"  src='https://via.placeholder.com/210x295/ffffff/666666/?text=TV'>":e+=`<img class="imgAnime" src=${t.images.jpg.image_url}>`,e+="</li>";listFavourites.innerHTML=e}function handleClickFavourite(e){const t=parseInt(e.currentTarget.id),i=dataAnime.find(e=>e.mal_id===t),n=favouritesAnime.findIndex(e=>e.mal_id===t);-1===n?favouritesAnime.push(i):favouritesAnime.splice(n,1),renderFavourites(),listenerAnimes()}function listenerAnimes(){const e=document.querySelectorAll(".js_eachAnime");for(const t of e)t.addEventListener("click",handleClickFavourite)}function renderAnime(){let e="",t="";for(const i of dataAnime){t=-1!==favouritesAnime.findIndex(e=>i.mal_id===e.mal_id)?"selected":"",e+=`<li class="listAnime ${t} js_eachAnime" id="${i.mal_id} ">`,e+=`<h3>${i.title}</h3>`,"https://cdn.myanimelist.net/img/sp/icon/apple-touch-icon-256.png"===i.images.jpg.image_url?e+=" <img class=\"imgAnime\"  src='https://via.placeholder.com/210x295/ffffff/666666/?text=TV'>":e+=`<img class="imgAnime" src=${i.images.jpg.image_url}>`,e+="</li>"}listResults.innerHTML=e,listenerAnimes()}function getAnimeData(){const e=inputUser.value;fetch("https://api.jikan.moe/v4/anime?q="+e).then(e=>e.json()).then(e=>{dataAnime=e.data,localStorage.setItem("data",JSON.stringify(favouritesAnime)),renderAnime()})}function handleClick(e){e.preventDefault(),getAnimeData()}function handleClickReset(){listResults.innerHTML="",userInput=""}function onLoad(){const e=JSON.parse(localStorage.getItem("data"));console.log(e),e?(favouritesAnime=e,renderFavourites(),console.log("usa LS")):(getAnimeData(),console.log("no estoy en el LS"))}btnSearch.addEventListener("click",handleClick),btnReset.addEventListener("click",handleClickReset),onLoad();